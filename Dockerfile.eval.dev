# =============================================================================
# Gomoku Coding Agent 开发环境 Dockerfile
# 用于 Claude Code 等 Coding Agent 进入容器进行开发工作
# =============================================================================

ARG NODE_VERSION=22
FROM node:${NODE_VERSION}-bullseye

# 代码包下载地址
ARG CODE_URL=https://deep-evaluation-set.tos-cn-beijing.volces.com/Gomoku-3e5b00f.zip

# Python 环境变量（标准配置，照抄即可）
ENV PYTHONUNBUFFERED=1 \
    PYTHONDONTWRITEBYTECODE=1 \
    PIP_NO_CACHE_DIR=off \
    PIP_DISABLE_PIP_VERSION_CHECK=on

# 第一步：安装系统依赖和开发工具
RUN apt-get update && apt-get install --no-install-recommends -y \
    build-essential \
    curl \
    wget \
    unzip \
    vim \
    less \
    htop \
    procps \
    net-tools \
    && apt-get clean \
    && rm -rf /var/lib/apt/lists/*

# 第二步：下载并解压代码（重要！）
RUN wget -O /tmp/code.zip ${CODE_URL} && \
    unzip /tmp/code.zip -d /tmp && \
    mkdir /workspace && \
    mv /tmp/Gomoku-main/* /workspace && \
    rm /tmp/code.zip

WORKDIR /workspace

# 第三步：安装 Python 依赖
RUN npm install

# 注意：没有 CMD 或 ENTRYPOINT！
